<CommandSet xmlns="http://schemas.datacontract.org/2004/07/Model" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><ArgumentLists xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><a:KeyValueOfstringArrayOfDeviceQueryResultzsY_SOkxf><a:Key>ONOFFList</a:Key><a:Value><DeviceQueryResult><Result>OFF</Result><Value>0</Value></DeviceQueryResult><DeviceQueryResult><Result>ON</Result><Value>1</Value></DeviceQueryResult></a:Value></a:KeyValueOfstringArrayOfDeviceQueryResultzsY_SOkxf></ArgumentLists><BasicHTTPAuthentication>false</BasicHTTPAuthentication><CanRecord>false</CanRecord><CommandSetVariables><StringObject><Value>LampHours</Value></StringObject></CommandSetVariables><Commands><Command><Arguments/><Description/><DontUseFooter>false</DontUseFooter><DontUseHeader>false</DontUseHeader><HTTPReferer i:nil="true"/><HTTPRequest>GET</HTTPRequest><HTTPURL i:nil="true"/><HttpHeaders/><Id>3cdc30de-b01e-44ae-823d-469796b9f56e</Id><Information i:nil="true"/><IsVariableCommand>false</IsVariableCommand><Name>Power On</Name><Selections/><SendArgumentsAsCommands>false</SendArgumentsAsCommands><SendHTTPAsync>false</SendHTTPAsync><Type i:nil="true"/><UseMessageAsURL>false</UseMessageAsURL><Value>&#x2;&#x0;&#x0;&#x0;&#x0;&#x2;</Value></Command><Command><Arguments/><Description/><DontUseFooter>false</DontUseFooter><DontUseHeader>false</DontUseHeader><HTTPReferer i:nil="true"/><HTTPRequest>GET</HTTPRequest><HTTPURL i:nil="true"/><HttpHeaders/><Id>57f667dd-5ca3-4709-90c6-9bbed1522452</Id><Information i:nil="true"/><IsVariableCommand>false</IsVariableCommand><Name>Power Off</Name><Selections/><SendArgumentsAsCommands>false</SendArgumentsAsCommands><SendHTTPAsync>false</SendHTTPAsync><Type i:nil="true"/><UseMessageAsURL>false</UseMessageAsURL><Value>&#x2;&#x1;&#x0;&#x0;&#x0;&#x3;</Value></Command><Command><Arguments/><Description/><DontUseFooter>false</DontUseFooter><DontUseHeader>false</DontUseHeader><HTTPReferer i:nil="true"/><HTTPRequest>GET</HTTPRequest><HTTPURL i:nil="true"/><HttpHeaders/><Id>4cc0c175-8e7d-4736-919f-475774ea116c</Id><Information i:nil="true"/><IsVariableCommand>false</IsVariableCommand><Name>Query Lamp</Name><Selections/><SendArgumentsAsCommands>false</SendArgumentsAsCommands><SendHTTPAsync>false</SendHTTPAsync><Type i:nil="true"/><UseMessageAsURL>false</UseMessageAsURL><Value>&#x3;&#x0;&#x0;&#x2;&#x0;&#x1;</Value></Command><Command><Arguments/><Description/><DontUseFooter>false</DontUseFooter><DontUseHeader>false</DontUseHeader><HTTPReferer i:nil="true"/><HTTPRequest>GET</HTTPRequest><HTTPURL i:nil="true"/><HttpHeaders/><Id>c5870f33-5e16-4ac8-b3e7-e17406f71a62</Id><Information i:nil="true"/><IsVariableCommand>false</IsVariableCommand><Name>Query</Name><Selections/><SendArgumentsAsCommands>false</SendArgumentsAsCommands><SendHTTPAsync>false</SendHTTPAsync><Type i:nil="true"/><UseMessageAsURL>false</UseMessageAsURL><Value>&#x0;À&#x0;&#x0;&#x0;À</Value></Command><Command><Arguments/><Description/><DontUseFooter>false</DontUseFooter><DontUseHeader>false</DontUseHeader><HTTPReferer i:nil="true"/><HTTPRequest>GET</HTTPRequest><HTTPURL i:nil="true"/><HttpHeaders/><Id>8f38a4fd-e7ac-4273-8c53-d9eb17932f90</Id><Information i:nil="true"/><IsVariableCommand>false</IsVariableCommand><Name>Query Power</Name><Selections/><SendArgumentsAsCommands>false</SendArgumentsAsCommands><SendHTTPAsync>false</SendHTTPAsync><Type i:nil="true"/><UseMessageAsURL>false</UseMessageAsURL><Value>&#x0;&#x0;&#x0;&#x1;&#x1;</Value></Command></Commands><CopyPlugInToDirectory>false</CopyPlugInToDirectory><DeviceType i:nil="true"/><DisplayHex>false</DisplayHex><Id>262c6d82-ba6a-4df0-89b6-fbb816fba9ec</Id><IsSystemCommandSet>false</IsSystemCommandSet><IsVisca>false</IsVisca><JavascriptSDKCode>exports.processResponse = function(data, d, sdk){&#xD;
	//  Code goes here...&#xD;
    var s= data.toString();&#xD;
    var lines = s.split("\r\n");&#xD;
       &#xD;
    lines.forEach(function(dataString){&#xD;
                var messageToLog = "";&#xD;
            for(var i = 0; i &lt; data.length; i++){&#xD;
            messageToLog += data[i] + ",";&#xD;
            }&#xD;
           sdk.logMessage(messageToLog + "Top");&#xD;
//Power&#xD;
   if(messageToLog.contains("32,133,1,32,16,0,0,1,0,0,4")){&#xD;
                var a = messageToLog.split(",");&#xD;
                    var b = a[10];&#xD;
                        var power = b;&#xD;
    if(power == "4")&#xD;
        power = "On";&#xD;
&#xD;
    sdk.setGlobalVariableValue("NEC Projector_Power", power);&#xD;
    }&#xD;
    &#xD;
    if(messageToLog.contains("32,133,1,32,16,0,0,0,0,0,15")){&#xD;
        var m = messageToLog.split(",");&#xD;
            var n = m[10];&#xD;
                var power = n;&#xD;
    &#xD;
    if(power == "15")&#xD;
        power = "Off";&#xD;
    &#xD;
    sdk.setGlobalVariableValue("NEC Projector_Power", power);    &#xD;
    }&#xD;
    &#xD;
//Lamp Hours&#xD;
    if(messageToLog.contains("35,140,1,32,16")){&#xD;
        var j = messageToLog.split(",");&#xD;
            var data01 = j[5];&#xD;
                var r = j[6];&#xD;
                    var w = j[7];&#xD;
                        var t = j[8];&#xD;
                            var data02 = (r*256);&#xD;
                                var data03 = (w*65536);&#xD;
                                    var data04 = (t*16777216);&#xD;
                                        var seconds =parseInt(data01) + parseInt(data02) + parseInt(data03) + parseInt(data04);&#xD;
                                            var totalHour = seconds/3600;&#xD;
                                                var hours = totalHour.toFixed(2);&#xD;
&#xD;
//    sdk.logMessage(seconds);                        &#xD;
//    sdk.logMessage(hours + "Hours");&#xD;
    &#xD;
    sdk.setGlobalVariableValue("NEC Projector_LampHours", hours);&#xD;
&#xD;
    }&#xD;
&#xD;
//Input&#xD;
&#xD;
&#xD;
    if(messageToLog.contains("32,133,1,32,16,0,255")){&#xD;
        var e = messageToLog.split(",");&#xD;
            var f = e[7];&#xD;
                var g = e[8];&#xD;
                    var h = e[9];&#xD;
                var input = f + g + h;&#xD;
                                                &#xD;
    if(input == "111")&#xD;
        input = "PC";&#xD;
    if(input == "121")&#xD;
        input = "Video";&#xD;
    if(input == "161")&#xD;
        input = "HDMI 1";&#xD;
    if(input == "261")&#xD;
        input = "HDMI 2";&#xD;
    &#xD;
    sdk.setGlobalVariableValue("NEC Projector_Input", input);&#xD;
 &#xD;
    sdk.logMessage(input + "Input");&#xD;
    }&#xD;
&#xD;
}&#xD;
);&#xD;
};&#xD;
&#xD;
</JavascriptSDKCode><KeepAliveCommandString i:nil="true"/><KeepAliveInterval>0</KeepAliveInterval><LookUpLists xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays"/><Manufacturer>NEC</Manufacturer><Name>NP-M311W</Name><NoSpaceBetweenArgCmd>true</NoSpaceBetweenArgCmd><PromptForPassword>false</PromptForPassword><PromptForUserName>false</PromptForUserName><Protocol>TCP</Protocol><RequiresAuthentication>false</RequiresAuthentication><ResponseAssemblyName i:nil="true"/><SendArgumentsFirst>false</SendArgumentsFirst><SendCarriageReturn>false</SendCarriageReturn><SendLineFeed>false</SendLineFeed><Settings><Setting><HasSpecialCharacters>false</HasSpecialCharacters><IsInternal>false</IsInternal><Name>IPAddress</Name><Options/><Prompt>IP Address</Prompt><ValidationMessage/><Value>127.0.0.1</Value></Setting><Setting><HasSpecialCharacters>false</HasSpecialCharacters><IsInternal>false</IsInternal><Name>PortNumber</Name><Options/><Prompt>Port Number</Prompt><ValidationMessage>Setting Not Valid</ValidationMessage><Value i:nil="true"/></Setting><Setting><HasSpecialCharacters>true</HasSpecialCharacters><IsInternal>false</IsInternal><Name>Header</Name><Options/><Prompt>Header</Prompt><ValidationMessage/><Value/></Setting><Setting><HasSpecialCharacters>true</HasSpecialCharacters><IsInternal>false</IsInternal><Name>Footer</Name><Options/><Prompt>Footer</Prompt><ValidationMessage/><Value/></Setting><Setting><HasSpecialCharacters>true</HasSpecialCharacters><IsInternal>false</IsInternal><Name>Argument Delimiter</Name><Options/><Prompt>Delimiter</Prompt><ValidationMessage/><Value/></Setting></Settings><TelnetPasswordKeyword i:nil="true"/><TelnetUsernameKeyword i:nil="true"/><UseBytes>false</UseBytes><Variables/><WaitForDeviceAck>false</WaitForDeviceAck></CommandSet>